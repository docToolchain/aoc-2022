<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>Aoc 2022: mr-kaffee</title>
    <meta charset="UTF-8">
<meta name="google-site-verification" content="JZ7jk3duxzxHDLuOHKPxc-uoz0JPlSBLeaAxh3wGn9Q" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Just for fun">
    <meta name="author" content="Ralf D. MÃ¼ller">
    <meta name="keywords" content="aoc">
    <meta name="generator" content="JBake">

    <!-- Le styles -->
    <link href="../../../css/bootstrap.min.css" rel="stylesheet">
    <link href="../../../css/asciidoctor.css" rel="stylesheet">
    <link href="../../../css/base.css" rel="stylesheet">
    <link href="../../../css/prettify.css" rel="stylesheet">
      <link href="../../../css/retro.css" rel="stylesheet">
      <style>
      @media only screen and (min-width:768px){
          #toctitle{font-size:1.375em}
          #toc.toc{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto; padding-top: 60px;}
          #toc.toc #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
          #toc.toc>ul{font-size:.9em;margin-bottom:0}
          #toc.toc ul ul{margin-left:0;padding-left:1em}
          #toc.toc ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
          body.toc2{ padding-left: 15.5em;padding-right:0; width: 100% !important;}
          body.toc2 div#wrap div.content {width: auto !important;}
          #toc.toc{width:15em; padding-top: 60px;}
      }
      @media only screen and (min-width:1280px){
          body.toc2{ padding-left: 20.5em;padding-right:0; width: 100% !important;}
          body.toc2 div#wrap div.content {width: auto !important;}
          #toc.toc{width:20em; padding-top: 60px;}
          #toc.toc #toctitle{font-size:1.375em}
          #toc.toc>ul{font-size:.95em}
          #toc.toc ul ul{padding-left:1.25em}
      }
      body {
          overflow-y: scroll;
      }
      html, body {
          font-size: 1.06rem;
      }
      body.toc2{ overflow-x: auto}
      #toc.toc ul {
          padding-inline-start: 0;
      }
      :target::before {
          content: "";
          display: block;
          height: 60px; /* fixed header height*/
          margin: -60px 0 0; /* negative fixed header height */
      }
      .navbar {
          background-image: url(/aoc-2022/images/treeback.png);
          background-size: contain;
          background-repeat: repeat-x;
          border-bottom: 0;
          padding-bottom: 20px;
          background-color: transparent;
          box-shadow: none;
      }
      html {
          background: url(/aoc-2022/images/snowback.png) no-repeat center center fixed;
          -webkit-background-size: cover;
          -moz-background-size: cover;
          -o-background-size: cover;
          background-size: cover;
      }

      </style>
      <script>
          //smart redirectg
          if (document.location.href.includes("netlify")) {
              document.location.href=document.location.href.replace("aoc-2022.netlify.app/","doctoolchain.org/aoc-2022/");
          }
      </script>
<!-- /aoc-2022/ -->

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="../../../js/html5shiv.min.js"></script>
    <![endif]-->

      <link rel="apple-touch-icon" sizes="180x180" href="/aoc-2022//apple-touch-icon.png">
      <link rel="icon" type="image/png" sizes="32x32" href="/aoc-2022//favicon-32x32.png">
      <link rel="icon" type="image/png" sizes="16x16" href="/aoc-2022//favicon-16x16.png">
      <link rel="manifest" href="/aoc-2022//site.webmanifest">
      <link rel="mask-icon" href="/aoc-2022//safari-pinned-tab.svg" color="#5bbad5">
      <meta name="msapplication-TileColor" content="#da532c">
      <meta name="theme-color" content="#ffffff">
  </head>

<body onload="prettyPrint()" class="toc2 toc-left" >
<div id="wrap">

	
	<!-- Fixed navbar -->
    <div class="navbar navbar-default navbar-fixed-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../../../">AoC-2022</a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
              
                
                  <li><a href="../../../rules/">Rules</a></li>
                
              
                
                  <li><a href="../../../solutions/">Solutions</a></li>
                
              
                
                  <li><a href="../../../about/">About</a></li>
                
              
          </ul>
            <!-- tag::search[] -->
            <form class="navbar-form navbar-right" action="https://google.de/search" style="border: none;">
                <div class="form-group">
                    <input type="hidden" name="q" value="site:doctoolchain.org/aoc-2022">
                    <input type="text" name="q" class="form-control" id="search">
                    <button type="submit" class="btn btn-default hidden-sm ">Find</button>
                </div>
            </form>
            <!-- end::search[] -->
        </div><!--/.nav-collapse -->
      </div>
    </div>

	<div class="container content">
	<p><div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_mr_kaffee">mr-kaffee</a>
<ul class="sectlevel2">
<li><a href="#_about_me">About me</a></li>
<li><a href="#_day_00_rust">Day 00: rust</a>
<ul class="sectlevel3">
<li><a href="#_day_00_hello_world">Day 00: Hello World!</a>
<ul class="sectlevel4">
<li><a href="#_run_solutions_for_several_days">Run solutions for several days</a></li>
<li><a href="#_general_structure">General structure</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_day_01_rust">Day 01: rust</a>
<ul class="sectlevel3">
<li><a href="#_day_1_calorie_counting">Day 1: Calorie Counting</a>
<ul class="sectlevel4">
<li><a href="#_input">Input</a></li>
<li><a href="#_star_1">Star 1</a></li>
<li><a href="#_star_2">Star 2</a></li>
<li><a href="#_tests_2">Tests</a></li>
<li><a href="#_today_i_learned">Today I learned</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_day_02_rust">Day 02: rust</a>
<ul class="sectlevel3">
<li><a href="#_day_2_rock_paper_scissors">Day 2: Rock Paper Scissors</a>
<ul class="sectlevel4">
<li><a href="#_input_2">Input</a></li>
<li><a href="#_star_1_2">Star 1</a></li>
<li><a href="#_star_2_2">Star 2</a></li>
<li><a href="#_tests_3">Tests</a></li>
<li><a href="#_today_i_learned_2">Today I learned</a></li>
<li><a href="#_alternative_based_on_direct_calculations">Alternative based on direct calculations</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_day_03_rust">Day 03: rust</a>
<ul class="sectlevel3">
<li><a href="#_day_3_rucksack_reorganization">Day 3: Rucksack Reorganization</a>
<ul class="sectlevel4">
<li><a href="#_input_3">Input</a></li>
<li><a href="#_star_1_3">Star 1</a></li>
<li><a href="#_star_2_3">Star 2</a></li>
<li><a href="#_tests_4">Tests</a></li>
<li><a href="#_today_i_learned_3">Today I learned</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="sect1">
<h2 id="_mr_kaffee"><a class="anchor" href="#_mr_kaffee"></a><a class="link" href="#_mr_kaffee">mr-kaffee</a></h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="https://avatars0.githubusercontent.com/u/73745454?v=4" alt="73745454?v=4" width="100px"></span></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><strong>mr-kaffee</strong><br>
Peter Wieland<br>
Github: <a href="https://github.com/mr-kaffee">mr-kaffee</a>,
Strava: <a href="https://www.strava.com/athletes/89256720">Peter Wieland</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="sect2">
<h3 id="_about_me"><a class="anchor" href="#_about_me"></a><a class="link" href="#_about_me">About me</a></h3>
<div class="paragraph">
<p>I am a regular SW coder. Each year in december, I code AoC puzzle solutions. This year, for the 3rd year in a row, I&#8217;ll go with Rust.</p>
</div>
<div class="paragraph">
<p>In my professional career, I used to do lots of Java and MATLAB coding, yet, this feels like very long time ago.</p>
</div>
<div class="paragraph">
<p>If I do not code or work, I enjoy <a href="https://www.strava.com/athletes/89256720">cycling</a> on or off roads, with or without electric support.</p>
</div>
<a id="day00" />
</div>
<div class="sect2">
<h3 id="_day_00_rust"><a class="anchor" href="#_day_00_rust"></a><a class="link" href="#_day_00_rust">Day 00: rust</a></h3>
<div class="sect3">
<h4 id="_day_00_hello_world"><a class="anchor" href="#_day_00_hello_world"></a><a class="link" href="#_day_00_hello_world">Day 00: Hello World!</a></h4>
<div class="paragraph">
<p>It&#8217;ll be the 3rd year of <a href="https://www.rust-lang.org/">Rust</a> solutions for the 2022 edition of
<a href="https://adventofcode.com/2021">Advent of Code</a></p>
</div>
<div class="paragraph">
<p>I created a little solution infrastrucutre (which resides in the <code>aoc</code> subfolder of <code>day00/rust/mr-kaffee</code>) I want to use in my solutions, and a small application that creates templates and downloads puzzle inputs (which resides in the <code>template</code> subfolder of <code>day00/rust/mr-kaffee</code>).</p>
</div>
<div class="paragraph">
<p>Other than that, my challenges are again to create solutions that perform well and that do not use external dependencies (the latter constraint is not applied for the Day 0 Hello World Example, which I also use to run all my solutions in a row).</p>
</div>
<div class="sect4">
<h5 id="_run_solutions_for_several_days"><a class="anchor" href="#_run_solutions_for_several_days"></a><a class="link" href="#_run_solutions_for_several_days">Run solutions for several days</a></h5>
<div class="paragraph">
<p>The Day 0 application can be used to run several of my solutions (they will be added as I create them) using <code>cargo run --release -- -d &lt;from&gt;..=&lt;to&gt;</code> or <code>cargo --run --release -- -d a,b,c,&#8230;&#8203;</code> where <code>a</code>, <code>b</code>, <code>c</code>, &#8230;&#8203; are numbers of specific days to run. If the <code>-d</code> argument is omitted, all solutions are run.</p>
</div>
</div>
<div class="sect4">
<h5 id="_general_structure"><a class="anchor" href="#_general_structure"></a><a class="link" href="#_general_structure">General structure</a></h5>
<div class="paragraph">
<p>My solutions will be implemented in a <code>src/lib.rs</code> file and generally have the structure detailed below. This is most probably a bit of an overhead, but fun to write and a learning opportunity for me.</p>
</div>
<div class="sect5">
<h6 id="_the_puzzle_definition"><a class="anchor" href="#_the_puzzle_definition"></a><a class="link" href="#_the_puzzle_definition">The Puzzle definition</a></h6>
<div class="paragraph">
<p>This is a function returing an instance of <code>mr_kaffee_aoc::Puzzle</code> which defines metadata, input data, references to solver functions and expected solutions.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight linenums"><code class="language-rust" data-lang="rust">pub fn puzzle() -&gt; Puzzle&lt;'static, PuzzleData, usize, usize, usize, usize&gt; {
    Puzzle {
        year: 2022,
        day: 0,
        input: include_str!("../input.txt"),
        star1: Some(Star {
            name: "Hello World example",
            f: &amp;star_1,
            exp: Some(0),
        }),
        star2: None,
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_data_structures"><a class="anchor" href="#_data_structures"></a><a class="link" href="#_data_structures">Data Structures</a></h6>
<div class="paragraph">
<p>This includes the code to parse the input data</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight linenums"><code class="language-rust" data-lang="rust">pub struct PuzzleData {
    input: &amp;'static str,
}

impl TryFrom&lt;&amp;'static str&gt; for PuzzleData {
    type Error = Infallible;

    fn try_from(input: &amp;'static str) -&gt; Result&lt;Self, Self::Error&gt; {
        Ok(Self { input })
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_the_solver_functions"><a class="anchor" href="#_the_solver_functions"></a><a class="link" href="#_the_solver_functions">The solver functions</a></h6>
<div class="paragraph">
<p>The main solver functions plus potentially helper functions</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight linenums"><code class="language-rust" data-lang="rust">pub fn star_1(data: &amp;PuzzleData) -&gt; usize {
    println!("{}", data.input);
    0
}</code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_tests"><a class="anchor" href="#_tests"></a><a class="link" href="#_tests">Tests</a></h6>
<div class="paragraph">
<p>Tests, in particular code to execute the test cases typically defined in the puzzles</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight linenums"><code class="language-rust" data-lang="rust">#[cfg(test)]
mod tests {
    use mr_kaffee_aoc::GenericPuzzle;

    use super::*;

    #[test]
    pub fn test_something() {
        let puzzle = puzzle();
        assert!(puzzle.solve_handle_err());
    }
}</code></pre>
</div>
</div>
<a id="day01" />
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_day_01_rust"><a class="anchor" href="#_day_01_rust"></a><a class="link" href="#_day_01_rust">Day 01: rust</a></h3>
<div class="sect3">
<h4 id="_day_1_calorie_counting"><a class="anchor" href="#_day_1_calorie_counting"></a><a class="link" href="#_day_1_calorie_counting">Day 1: Calorie Counting</a></h4>
<div class="paragraph">
<p><a href="https://rust-lang.org">Rust</a> solution to <a href="https://adventofcode.com/2022/day/1">AoC|2022|1</a>.</p>
</div>
<div class="paragraph">
<p>Nothing very interesting today.</p>
</div>
<div class="sect4">
<h5 id="_input"><a class="anchor" href="#_input"></a><a class="link" href="#_input">Input</a></h5>
<div class="paragraph">
<p>Parse everything in a vec of sums (initially I used a vec of vecs; since individual elements are never needed sums are enough)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight linenums"><code class="language-rust" data-lang="rust">pub mod input {
    use std::num::ParseIntError;

    #[derive(Debug)]
    pub struct PuzzleData {
        pub calories: Vec&lt;usize&gt;,
    }

    impl TryFrom&lt;&amp;'static str&gt; for PuzzleData {
        type Error = ParseIntError;

        /// parse the puzzle input
        fn try_from(s: &amp;'static str) -&gt; Result&lt;Self, Self::Error&gt; {
            s.split("\n\n")
                .map(|elf| elf.lines().map(|l| l.parse::&lt;usize&gt;()).sum())
                .collect::&lt;Result&lt;Vec&lt;_&gt;, _&gt;&gt;()
                .map(|calories| Self { calories })
        }
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_star_1"><a class="anchor" href="#_star_1"></a><a class="link" href="#_star_1">Star 1</a></h5>
<div class="paragraph">
<p>Just find the biggest sum (I use <code>fold</code> instead of <code>max</code> to not handle the <code>Option::None</code> case)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight linenums"><code class="language-rust" data-lang="rust">pub fn star_1(data: &amp;PuzzleData) -&gt; usize {
    data.calories.iter().fold(0, |mx, &amp;cal| mx.max(cal))
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_star_2"><a class="anchor" href="#_star_2"></a><a class="link" href="#_star_2">Star 2</a></h5>
<div class="paragraph">
<p>Sum the three biggest sums. First solution used <code>Vec::sort</code>. New solution does not use any sorting and should be <code>O(n)</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight linenums"><code class="language-rust" data-lang="rust">pub fn star_2(data: &amp;PuzzleData) -&gt; usize {
    data.calories
        .iter()
        .fold([0; 3], |mut mx, &amp;cal| {
            if cal &gt; mx[0] {
                mx[2] = mx[1];
                mx[1] = mx[0];
                mx[0] = cal;
            } else if cal &gt; mx[1] {
                mx[2] = mx[1];
                mx[1] = cal;
            } else if cal &gt; mx[2] {
                mx[2] = cal;
            }
            mx
        })
        .iter()
        .sum()
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_tests_2"><a class="anchor" href="#_tests_2"></a><a class="link" href="#_tests_2">Tests</a></h5>
<div class="paragraph">
<p>No tests today. It was too simple.</p>
</div>
</div>
<div class="sect4">
<h5 id="_today_i_learned"><a class="anchor" href="#_today_i_learned"></a><a class="link" href="#_today_i_learned">Today I learned</a></h5>
<div class="paragraph">
<p>Not so much. My template works.</p>
</div>
<div class="paragraph">
<p>Iterating/refactoring the solution, I learned that <code>std::iter::Sum</code> has an implementation <code>impl&lt;T, U, E&gt; Sum&lt;Result&lt;U, E&gt;&gt; for Result&lt;T, E&gt;</code>.</p>
</div>
<a id="day02" />
</div>
</div>
</div>
<div class="sect2">
<h3 id="_day_02_rust"><a class="anchor" href="#_day_02_rust"></a><a class="link" href="#_day_02_rust">Day 02: rust</a></h3>
<div class="sect3">
<h4 id="_day_2_rock_paper_scissors"><a class="anchor" href="#_day_2_rock_paper_scissors"></a><a class="link" href="#_day_2_rock_paper_scissors">Day 2: Rock Paper Scissors</a></h4>
<div class="paragraph">
<p><a href="https://rust-lang.org">Rust</a> solution to <a href="https://adventofcode.com/2022/day/2">AoC|2022|2</a>.</p>
</div>
<div class="sect4">
<h5 id="_input_2"><a class="anchor" href="#_input_2"></a><a class="link" href="#_input_2">Input</a></h5>
<div class="paragraph">
<p>I have two enums to parse the first column (A, B, C to <code>RockPaperScissors</code>) and the second column (X, Y, Z to <code>XYZ</code>).</p>
</div>
<div class="paragraph">
<p>It would have been much simpler to parse both into 0, 1, 2 and than use some simple formulas later on (which I did as an alternative, see below), but my solution fails gracefully if something unexpected comes in the input ;)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight linenums"><code class="language-rust" data-lang="rust">pub mod input {

    #[derive(Debug, Clone, Copy, PartialEq, Eq)]
    pub enum RockPaperScissors {
        Rock,
        Paper,
        Scissors,
    }

    #[derive(Debug, Clone, Copy, PartialEq, Eq)]
    pub enum XYZ {
        X,
        Y,
        Z,
    }

    #[derive(Debug)]
    pub struct PuzzleData {
        pub strategy: Vec&lt;(RockPaperScissors, XYZ)&gt;,
    }

    impl TryFrom&lt;&amp;'static str&gt; for PuzzleData {
        type Error = String;

        /// parse the puzzle input
        fn try_from(s: &amp;'static str) -&gt; Result&lt;Self, Self::Error&gt; {
            s.lines()
                .map(|l| {
                    l.split_once(' ')
                        .ok_or_else(|| format!("Could not parse line '{l}'"))
                        .and_then(|(a, b)| {
                            match a {
                                "A" =&gt; Ok(RockPaperScissors::Rock),
                                "B" =&gt; Ok(RockPaperScissors::Paper),
                                "C" =&gt; Ok(RockPaperScissors::Scissors),
                                _ =&gt; Err(format!("Expected one of A, B, C, found '{a}'")),
                            }
                            .and_then(|a| match b {
                                "X" =&gt; Ok((a, XYZ::X)),
                                "Y" =&gt; Ok((a, XYZ::Y)),
                                "Z" =&gt; Ok((a, XYZ::Z)),
                                _ =&gt; Err(format!("Expected one of X, Y, Z, found '{b}'")),
                            })
                        })
                })
                .collect::&lt;Result&lt;Vec&lt;_&gt;, _&gt;&gt;()
                .map(|strategy| Self { strategy })
        }
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_star_1_2"><a class="anchor" href="#_star_1_2"></a><a class="link" href="#_star_1_2">Star 1</a></h5>
<div class="paragraph">
<p>For star 1 I directly convert `XYZ`s to `RockPaperScissors&#8217; using</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight linenums"><code class="language-rust" data-lang="rust">    fn to_rock_paper_scissors(&amp;self) -&gt; RockPaperScissors {
        match self {
            XYZ::X =&gt; RockPaperScissors::Rock,
            XYZ::Y =&gt; RockPaperScissors::Paper,
            XYZ::Z =&gt; RockPaperScissors::Scissors,
        }
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>The scores are calculated with</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight linenums"><code class="language-rust" data-lang="rust">    fn result(&amp;self, other: &amp;Self) -&gt; usize {
        match (self, other) {
            (RockPaperScissors::Rock, RockPaperScissors::Rock) =&gt; 1 + 3,
            (RockPaperScissors::Rock, RockPaperScissors::Paper) =&gt; 1 + 0,
            (RockPaperScissors::Rock, RockPaperScissors::Scissors) =&gt; 1 + 6,
            (RockPaperScissors::Paper, RockPaperScissors::Rock) =&gt; 2 + 6,
            (RockPaperScissors::Paper, RockPaperScissors::Paper) =&gt; 2 + 3,
            (RockPaperScissors::Paper, RockPaperScissors::Scissors) =&gt; 2 + 0,
            (RockPaperScissors::Scissors, RockPaperScissors::Rock) =&gt; 3 + 0,
            (RockPaperScissors::Scissors, RockPaperScissors::Paper) =&gt; 3 + 6,
            (RockPaperScissors::Scissors, RockPaperScissors::Scissors) =&gt; 3 + 3,
        }
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>And the solution is</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight linenums"><code class="language-rust" data-lang="rust">pub fn star_1(data: &amp;PuzzleData) -&gt; usize {
    data.strategy
        .iter()
        .map(|(a, b)| b.to_rock_paper_scissors().result(a))
        .sum()
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_star_2_2"><a class="anchor" href="#_star_2_2"></a><a class="link" href="#_star_2_2">Star 2</a></h5>
<div class="paragraph">
<p>I was expecting an optimization for the second part of the kind, "Figure out what X, Y, Z need to be so you end up with the highest score possible" or "&#8230;&#8203; so that you end up with the lowest score possible that with more than 50% wins". Maybe that would have been too much for day 2.</p>
</div>
<div class="paragraph">
<p>The scores are still calculated in the same way but the conversion is now done using</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight linenums"><code class="language-rust" data-lang="rust">    fn for_result(&amp;self, opponent: &amp;RockPaperScissors) -&gt; RockPaperScissors {
        match (&amp;self, opponent) {
            (XYZ::X, RockPaperScissors::Rock) =&gt; RockPaperScissors::Scissors,
            (XYZ::X, RockPaperScissors::Paper) =&gt; RockPaperScissors::Rock,
            (XYZ::X, RockPaperScissors::Scissors) =&gt; RockPaperScissors::Paper,
            (XYZ::Y, _) =&gt; *opponent,
            (XYZ::Z, RockPaperScissors::Rock) =&gt; RockPaperScissors::Paper,
            (XYZ::Z, RockPaperScissors::Paper) =&gt; RockPaperScissors::Scissors,
            (XYZ::Z, RockPaperScissors::Scissors) =&gt; RockPaperScissors::Rock,
        }
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>The solution is</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight linenums"><code class="language-rust" data-lang="rust">pub fn star_2(data: &amp;PuzzleData) -&gt; usize {
    data.strategy
        .iter()
        .map(|(a, b)| b.for_result(a).result(a))
        .sum()
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_tests_3"><a class="anchor" href="#_tests_3"></a><a class="link" href="#_tests_3">Tests</a></h5>
<div class="paragraph">
<p>I made a mistake in my scoring function in the first place. So I wrote tests this time to debug this&#8230;&#8203;</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight linenums"><code class="language-rust" data-lang="rust">#[cfg(test)]
mod tests {
    use super::*;

    const CONTENT: &amp;str = r#"A Y
B X
C Z"#;

    #[test]
    pub fn test_star_1() {
        let data = PuzzleData::try_from(CONTENT).unwrap();
        assert_eq!(15, star_1(&amp;data));
    }

    #[test]
    pub fn test_star_2() {
        let data = PuzzleData::try_from(CONTENT).unwrap();
        assert_eq!(12, star_2(&amp;data));
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_today_i_learned_2"><a class="anchor" href="#_today_i_learned_2"></a><a class="link" href="#_today_i_learned_2">Today I learned</a></h5>
<div class="paragraph">
<p>I think it was the first time I used <code>Result::and_then</code> in a (maybe) meaningful way.</p>
</div>
</div>
<div class="sect4">
<h5 id="_alternative_based_on_direct_calculations"><a class="anchor" href="#_alternative_based_on_direct_calculations"></a><a class="link" href="#_alternative_based_on_direct_calculations">Alternative based on direct calculations</a></h5>
<div class="paragraph">
<p>I could not stop myself from implementing an alternative solution using direct calculations. Run the alternative solution with <code>cargo run --release --features modulo</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight linenums"><code class="language-rust" data-lang="rust">    pub fn star_1(data: &amp;PuzzleData) -&gt; usize {
        // 0 rock
        // 1 paper
        // 2 scissor
        // (rock - paper + 1) % 3 = 0
        // (rock - rock + 1) % 3 = 1
        // (rock - scissor + 1) % 3 = 2
        data.strategy
            .iter()
            .map(|(a, b)| ((b + 4 - a) % 3) * 3 + (b + 1))
            .sum()
    }

    pub fn star_2(data: &amp;PuzzleData) -&gt; usize {
        // 0 rock, 1 paper, 2 scissor
        // 0 loose, 1 draw, 2 win
        // to loose, subtract 1 (% 3), to win add 1 (% 3)
        // play (a + b - 1) % 3 -&gt; add this in formula for first star
        data.strategy
            .iter()
            .map(|(a, b)| b * 3 + (a + b + 2) % 3 + 1)
            .sum()
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>I also implemented a parse function which does not check any inputs and will probably result in panics if something unexpected is in the input (to parse without error handling run <code>cargo run --release --features unchecked_parse</code>; this will automatically use the direct calculation variant)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight linenums"><code class="language-rust" data-lang="rust">    impl TryFrom&lt;&amp;'static str&gt; for PuzzleData {
        type Error = String;

        /// parse the puzzle input
        fn try_from(s: &amp;'static str) -&gt; Result&lt;Self, Self::Error&gt; {
            if cfg!(feature = "unchecked_parse") {
                Ok(Self {
                    strategy: s
                        .lines()
                        .map(str::as_bytes)
                        .map(|bytes| ((bytes[0] - b'A') as usize, (bytes[2] - b'X') as usize))
                        .collect(),
                })
            } else {
                s.lines()
                    .map(|l| {
                        l.split_once(' ')
                            .ok_or_else(|| format!("Could not parse line '{l}'"))
                            .and_then(|(a, b)| {
                                match a {
                                    "A" =&gt; Ok(0),
                                    "B" =&gt; Ok(1),
                                    "C" =&gt; Ok(2),
                                    _ =&gt; Err(format!("Expected one of A, B, C, found '{a}'")),
                                }
                                .and_then(|a| match b {
                                    "X" =&gt; Ok((a, 0)),
                                    "Y" =&gt; Ok((a, 1)),
                                    "Z" =&gt; Ok((a, 2)),
                                    _ =&gt; Err(format!("Expected one of X, Y, Z, found '{b}'")),
                                })
                            })
                    })
                    .collect::&lt;Result&lt;Vec&lt;_&gt;, _&gt;&gt;()
                    .map(|strategy| Self { strategy })
            }
        }
    }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Interestingly, not doing any error handling in parsing the input does not lead to any measurable speed-up. Maybe this is because the overall solution time is so small, that the differences are not distinguishable from noise?</p>
</div>
<a id="day03" />
</div>
</div>
</div>
<div class="sect2">
<h3 id="_day_03_rust"><a class="anchor" href="#_day_03_rust"></a><a class="link" href="#_day_03_rust">Day 03: rust</a></h3>
<div class="sect3">
<h4 id="_day_3_rucksack_reorganization"><a class="anchor" href="#_day_3_rucksack_reorganization"></a><a class="link" href="#_day_3_rucksack_reorganization">Day 3: Rucksack Reorganization</a></h4>
<div class="paragraph">
<p><a href="https://rust-lang.org">Rust</a> solution to <a href="https://adventofcode.com/2022/day/3">AoC|2022|3</a>.</p>
</div>
<div class="sect4">
<h5 id="_input_3"><a class="anchor" href="#_input_3"></a><a class="link" href="#_input_3">Input</a></h5>
<div class="paragraph">
<p>I parse the input directly into a vec of vecs of bytes, each representing the priority of the items contained in the rucksacks.</p>
</div>
<div class="paragraph">
<p>I was tempted to think about using sets for quicker <code>contains</code> operations, but given the size of the problem, this is most likely not worth it.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight linenums"><code class="language-rust" data-lang="rust">pub mod input {
    #[derive(Debug)]
    pub struct PuzzleData {
        pub rucksacks: Vec&lt;Vec&lt;u8&gt;&gt;,
    }

    impl TryFrom&lt;&amp;'static str&gt; for PuzzleData {
        type Error = &amp;'static str;

        /// parse the puzzle input
        fn try_from(s: &amp;'static str) -&gt; Result&lt;Self, Self::Error&gt; {
            s.lines()
                .map(|l| {
                    l.as_bytes()
                        .iter()
                        .map(|&amp;b| match b {
                            b'a'..=b'z' =&gt; Ok(b - b'a' + 1),
                            b'A'..=b'Z' =&gt; Ok(b - b'A' + 27),
                            _ =&gt; Err("Unexpected bytes in input"),
                        })
                        .collect::&lt;Result&lt;Vec&lt;_&gt;, _&gt;&gt;()
                })
                .collect::&lt;Result&lt;Vec&lt;_&gt;, _&gt;&gt;()
                .map(|rucksacks| Self { rucksacks })
        }
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_star_1_3"><a class="anchor" href="#_star_1_3"></a><a class="link" href="#_star_1_3">Star 1</a></h5>
<div class="paragraph">
<p>Star 1 is about finding the item in the first compartment (first half) of the rucksack, which is also contained in the secod half.</p>
</div>
<div class="paragraph">
<p>Some simplifications work because / if the input is correct.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>I assume that a common item always exists and therefore do not limit the search to the first half (it will stop once an item is found, which will be in the first half)</p>
</li>
<li>
<p>The <code>find</code> function returns an <code>Option</code>. If there were any <code>None</code> values, they would be simply discarded using <code>filter_map</code> (actually, for part 1, there can be no <code>None</code> values, because search is not stopped in the first half, so the first element of the second half would be found, if there is no common element between first and second half. so a simple <code>unwrap</code> would work as well).</p>
</li>
<li>
<p>The <code>chunks_exact</code> function makes sure that every chunk has exactly three elements. If the overall number of rucksacks was not a multiple of three, the remaining rucksacks would simply be discarded.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>I use a <code>fold</code> instead of <code>sum</code> to do type conversion on the fly (<code>u8</code> would not be big enough to hold the sum).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight linenums"><code class="language-rust" data-lang="rust">pub fn star_1(data: &amp;PuzzleData) -&gt; usize {
    data.rucksacks
        .iter()
        .filter_map(|rucksack| {
            rucksack
                .iter()
                .find(|item| rucksack.as_slice()[rucksack.len() / 2..].contains(item))
        })
        .fold(0usize, |sum, item| sum + *item as usize)
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_star_2_3"><a class="anchor" href="#_star_2_3"></a><a class="link" href="#_star_2_3">Star 2</a></h5>
<div class="paragraph">
<p>Star 2 is a simple modification, where we look for items that are common for groups of three consecutive rucksacks</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight linenums"><code class="language-rust" data-lang="rust">pub fn star_2(data: &amp;PuzzleData) -&gt; usize {
    data.rucksacks
        .chunks_exact(3)
        .filter_map(|group| {
            group[0]
                .iter()
                .find(|item| group[1].contains(item) &amp;&amp; group[2].contains(item))
        })
        .fold(0usize, |sum, item| sum + *item as usize)
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_tests_4"><a class="anchor" href="#_tests_4"></a><a class="link" href="#_tests_4">Tests</a></h5>
<div class="paragraph">
<p>Tests use the example given in the puzzle.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="prettyprint highlight linenums"><code class="language-rust" data-lang="rust">#[cfg(test)]
mod tests {
    use super::*;

    const CONTENT: &amp;str = r#"vJrwpWtwJgWrhcsFMMfFFhFp
jqHRNqRjqzjGDLGLrsFMfFZSrLrFZsSL
PmmdzqPrVvPwwTWBwg
wMqvLMZHhHMvwLHjbvcjnnSBnvTQFn
ttgJtRGJQctTZtZT
CrZsJsPPZsGzwwsLwLmpwMDw"#;

    #[test]
    pub fn test_star_1() {
        let data = PuzzleData::try_from(CONTENT).unwrap();
        assert_eq!(157, star_1(&amp;data));
    }

    #[test]
    pub fn test_star_2() {
        let data = PuzzleData::try_from(CONTENT).unwrap();
        assert_eq!(70, star_2(&amp;data));
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_today_i_learned_3"><a class="anchor" href="#_today_i_learned_3"></a><a class="link" href="#_today_i_learned_3">Today I learned</a></h5>
<div class="paragraph">
<p>... that sometimes it is as simple as it appears at first view.</p>
</div>
</div>
</div>
</div>
</div>
</div></p>

	</div>

</div>
<div id="push"></div>
</div>


    <div id="footer">
      <div class="container">
          <p class="muted credit">&copy; 2022 | Mixed with Bootstrap v3.1.1 | generated with <a href="https://doctoolchain.org">docToolchain</a> | Baked with JBake v2.6.4</p>
      </div>
    </div>
    
    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>
    <script src="../../../js/bootstrap.min.js"></script>
    <script src="../../../js/prettify.js"></script>
    


</body>
</html>